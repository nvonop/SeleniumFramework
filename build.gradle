apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'jacoco'
apply plugin: 'sonar-runner'

	repositories {
	    mavenCentral()
	}

	dependencies {
	    compile "org.seleniumhq.selenium:selenium-java:2.31.0"
	    compile "org.testng:testng:6.3.1"
	    compile group: 'com.google.inject', name: 'guice', version: '3.0'
	    compile("org.uncommons:reportng:1.1.2") {
	    exclude group: "org.testng", module: "testng"
	    }
	}
	
	buildscript {
    repositories { mavenCentral() }
    dependencies { classpath 'org.ajoberstar:gradle-jacoco:0.1.0' }
}

	sourceSets {
	    main {
	        java {
	            srcDir 'src/framework/'
	        }
	        resources {
	            srcDir 'src/framework/resources'
	        }
	    }
	}
	
	tasks.withType(Test) {
	    useTestNG()
	    systemProperties = System.getProperties()
	    maxParallelForks = 3
	}

	task runFrameworkTests(type: Test) {
	    useTestNG() {
	        includeGroups 'frameworkTests'
	    }
	}
	
	task runIETests(type: Test) {
	   systemProperties['LOCAL_DRIVER'] = false
		systemProperties['REMOTE_DRIVER'] = false
		systemProperties['SAUCE_DRIVER'] = true
		systemProperties['SAUCE_KEY'] = 'http://nvonop:a391bf40-5eb1-44f9-812a-c1ce5492a5c9@ondemand.saucelabs.com:80/wd/hub'
		systemProperties['BROWSER'] = 'internet explorer'
		systemProperties['VERSION'] = '9'
		systemProperties['PLATFORM'] = 'Windows 2008'
	}
	
	task runFirefoxTests(type: Test) {
	   systemProperties['LOCAL_DRIVER'] = false
		systemProperties['REMOTE_DRIVER'] = false
		systemProperties['SAUCE_DRIVER'] = true
		systemProperties['SAUCE_KEY'] = 'http://nvonop:a391bf40-5eb1-44f9-812a-c1ce5492a5c9@ondemand.saucelabs.com:80/wd/hub'
		systemProperties['BROWSER'] = 'firefox'
		systemProperties['VERSION'] = '20'
		systemProperties['PLATFORM'] = 'Windows 2008'
	}
	
	task runChromeTests(type: Test) {
	   systemProperties['LOCAL_DRIVER'] = false
		systemProperties['REMOTE_DRIVER'] = false
		systemProperties['SAUCE_DRIVER'] = true
		systemProperties['SAUCE_KEY'] = 'http://nvonop:a391bf40-5eb1-44f9-812a-c1ce5492a5c9@ondemand.saucelabs.com:80/wd/hub'
		systemProperties['BROWSER'] = 'chrome'
		systemProperties['PLATFORM'] = 'Windows 2008'
	}
	
	
    
  test {
  	
	   systemProperties['LOCAL_DRIVER'] = false
		systemProperties['REMOTE_DRIVER'] = false
		systemProperties['SAUCE_DRIVER'] = true
		systemProperties['SAUCE_KEY'] = 'http://nvonop:a391bf40-5eb1-44f9-812a-c1ce5492a5c9@ondemand.saucelabs.com:80/wd/hub'
		systemProperties['BROWSER'] = 'internet explorer'
		systemProperties['VERSION'] = '9'
		systemProperties['PLATFORM'] = 'Windows 2008'
  }

  jar {
  	exclude('src/test')
  }
  
  sonarRunner {
    sonarProperties {
      property "sonar.host.url", "http://localhost:9000"
      property "sonar.jdbc.url", "jdbc:h2:tcp://localhost:9092/sonar"
      property "sonar.jdbc.driverClassName", "org.h2.Driver"
      property "sonar.jdbc.username", "sonar"
      property "sonar.jdbc.password", "sonar"
      property "sonar.jacoco.reportPath", "${project.buildDir}/jacoco/test.exec"
      property "sonar.sources", 'src'
      property "sonar.tests", 'src/test'
      
    }
}
