apply plugin: 'java'
apply plugin: 'maven'
apply plugin: 'eclipse'
apply plugin: 'groovy'

group = 'org.nvonop.selenium.framework'
version = '1.2.4'

repositories {
	// Spock releases are available from Maven Central
	mavenCentral()
	// Spock snapshots are available from the Sonatype OSS snapshot repository
	maven { url "http://oss.sonatype.org/content/repositories/snapshots/" }
}

dependencies {
	compile "org.codehaus.groovy:groovy-all:2.1.5"
	testCompile "org.spockframework:spock-core:1.0-groovy-2.0-SNAPSHOT"
	compile "org.seleniumhq.selenium:selenium-java:2.+"
	compile "org.testng:testng:6.3.1"
	compile group: 'com.google.inject', name: 'guice', version: '3.0'
	compile("org.uncommons:reportng:1.1.2") {
		exclude group: "org.testng", module: "testng"
	}

}


//	sourceSets {
//	    main {
//	        java {
//	            srcDir 'src/org/nvonop/selenium/framework'
//	        }
//	    }
//	    test {
//	        java {
//	            srcDir 'src/org/nvonop/selenium/test/java'
//	        }
//	        resources {
//	            srcDir 'src/org/nvonop/selenium/test/resources'
//	        }
//	    }
//	}

//tasks.withType(Test) {
//	useTestNG()
//	systemProperties = System.getProperties()
//	maxParallelForks = 2
//}

task runFrameworkTests(type: Test) {
	useTestNG() { includeGroups 'frameworkTests' }
}

task runIETests(type: Test) {
	useTestNG()
	systemProperties = System.getProperties()
	maxParallelForks = 2
	systemProperties['LOCAL_DRIVER'] = false
	systemProperties['REMOTE_DRIVER'] = false
	systemProperties['SAUCE_DRIVER'] = true
	systemProperties['SAUCE_KEY'] = 'http://nvonop:a391bf40-5eb1-44f9-812a-c1ce5492a5c9@ondemand.saucelabs.com:80/wd/hub'
	systemProperties['BROWSER'] = 'internet explorer'
	systemProperties['VERSION'] = '9'
	systemProperties['PLATFORM'] = 'Windows 2008'
	systemProperties['APPLICATION_URL'] = "http://selenium-framework.site44.com/controls_page.html"
	systemProperties['TEST_RESULTS_PATH'] = './build/Screenshots'
	}

task runFirefoxTests(type: Test) {
	useTestNG()
	systemProperties = System.getProperties()
	maxParallelForks = 2
	systemProperties['LOCAL_DRIVER'] = true
	systemProperties['REMOTE_DRIVER'] = false
	systemProperties['SAUCE_DRIVER'] = false
	systemProperties['SAUCE_KEY'] = 'http://nvonop:a391bf40-5eb1-44f9-812a-c1ce5492a5c9@ondemand.saucelabs.com:80/wd/hub'
	systemProperties['BROWSER'] = 'firefox'
	systemProperties['VERSION'] = '20'
	systemProperties['PLATFORM'] = 'Windows 2008'
	systemProperties['APPLICATION_URL'] = "http://selenium-framework.site44.com/controls_page.html"
	systemProperties['TEST_RESULTS_PATH'] = './build/Screenshots'
	}

task runChromeTests(type: Test) {
	useTestNG()
	systemProperties = System.getProperties()
	maxParallelForks = 2
	systemProperties['LOCAL_DRIVER'] = false
	systemProperties['REMOTE_DRIVER'] = false
	systemProperties['SAUCE_DRIVER'] = true
	systemProperties['SAUCE_KEY'] = 'http://nvonop:a391bf40-5eb1-44f9-812a-c1ce5492a5c9@ondemand.saucelabs.com:80/wd/hub'
	systemProperties['BROWSER'] = 'chrome'
	systemProperties['PLATFORM'] = 'Windows 2008'
	systemProperties['APPLICATION_URL'] = "http://selenium-framework.site44.com/controls_page.html"
	systemProperties['TEST_RESULTS_PATH'] = './build/Screenshots'
	}



test {
	systemProperties = System.getProperties()
	maxParallelForks = 2
	systemProperties['LOCAL_DRIVER'] = true
	systemProperties['REMOTE_DRIVER'] = false
	systemProperties['SAUCE_DRIVER'] = false
	systemProperties['SAUCE_KEY'] = 'http://nvonop:a391bf40-5eb1-44f9-812a-c1ce5492a5c9@ondemand.saucelabs.com:80/wd/hub'
	systemProperties['GRID_HOST'] = 'localhost'
	systemProperties['GRID_PORT'] = '4444'
	systemProperties['BROWSER'] = 'firefox'
	systemProperties['VERSION'] = ''
	systemProperties['PLATFORM'] = ''
	systemProperties['TIMEOUT'] = '10'
	systemProperties['TEST_RESULTS_PATH'] = './build/Screenshots'
	systemProperties['APPLICATION_URL'] = "http://selenium-framework.site44.com/controls_page.html"
}

task sourcesJar(type: Jar, dependsOn: classes) {
	classifier = 'sources'
	from sourceSets.main.allSource
}

jar { exclude('src/org/nvonop/selenium/test') }


uploadArchives {
	repositories {
		mavenDeployer {
			repository (
					url: 'https://api.bintray.com/maven/nvonop/maven/SeleniumFramework'
					) {
						authentication(
								userName: 'nvonop',
								password: '1f0da707e9e572d5ec330655d7bb981bcfe8958a'
								)
					}
		}
	}
}

